<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>Proof Upload</title>

<style>
:root{
  --bg:#020617;--card:#020617;--border:#1f2937;
  --text:#e5e7eb;--muted:#94a3b8;--accent:#2563eb;
}
:root[data-theme="light"]{
  --bg:#f8fafc;--card:#ffffff;--border:#e5e7eb;
  --text:#0f172a;--muted:#475569;--accent:#2563eb;
}
body{margin:0;font-family:system-ui;background:var(--bg);color:var(--text);}
.card{border:1px solid var(--border);border-radius:16px;padding:18px;}
button{cursor:pointer;width:100%;padding:10px;border-radius:10px;
border:none;background:var(--accent);color:white;font-weight:600;}
input,select{
  width:100%;padding:10px;margin-bottom:12px;
  background:var(--bg);color:var(--text);
  border:1px solid var(--border);border-radius:10px;
}
</style>
</head>

<body>

<nav style="display:flex;justify-content:space-between;align-items:center;
padding:14px 18px;border-bottom:1px solid var(--border);background:var(--card);">
  <div style="display:flex;gap:16px;">
    <a href="index.html">Tasks</a>
    <a href="habits.html">Habits</a>
    <a href="proofs.html" class="active">Proofs</a>
  </div>
  <button onclick="toggleTheme()">üåó</button>
</nav>

<div style="max-width:520px;margin:24px auto;padding:0 16px;">
  <div class="card">
    <h3>Upload Proof üì∏</h3>
    <p style="color:var(--muted);font-size:14px;">
      Upload image proof for completed work.
    </p>

    <select id="source">
      <option value="checklist">Checklist</option>
      <option value="delegation">Delegation</option>
      <option value="habit">Habit</option>
    </select>

    <input id="taskRef" placeholder="Task / Habit name">
    <input type="file" id="file" accept="image/*" capture="environment">

    <button onclick="upload()">Upload</button>

    <div id="status" style="margin-top:12px;font-size:14px;"></div>
  </div>
</div>

<script>
function applyTheme(){
  document.documentElement.dataset.theme=
    localStorage.getItem("theme")||"dark";
}
function toggleTheme(){
  const t=localStorage.getItem("theme")==="dark"?"light":"dark";
  localStorage.setItem("theme",t);applyTheme();
}
applyTheme();

const WORKER_URL="https://entirenewwrker.rkknitfabsachin.workers.dev/";
const USER_EMAIL="rkknitfabsachin@gmail.com";

function upload(){
  const f=file.files[0];
  if(!f||!taskRef.value.trim())return alert("Missing data");
  status.textContent="Uploading‚Ä¶";

  const r=new FileReader();
  r.onload=()=>{
    fetch(WORKER_URL,{
      method:"POST",
      headers:{ "Content-Type":"application/json" },
      body:JSON.stringify({
        action:"saveProof",
        email:USER_EMAIL,
        source:source.value,
        taskRef:taskRef.value.trim(),
        imageUrl:r.result
      })
    })
    .then(r=>r.json())
    .then(res=>{
      status.textContent=res.success?"Uploaded ‚úÖ":"Failed ‚ùå";
      file.value="";taskRef.value="";
    });
  };
  r.readAsDataURL(f);
}
</script>

</body>
</html>
